---
title: "Azure Entra ID SSO – Setting up Sitecore Cloud Portal"
date: 2025-10-13
draft: false
tags: ["azure", "identity", "sso", "sitecore", "cloud portal", "saml", "xm cloud", "search"]
summary: "Upload the federation metadata, configure the SAML connection, and perform initial validation for Sitecore Cloud Portal SSO."
---

## Introduction

Now that the Azure Entra ID side is complete, it’s time to bring Sitecore Cloud Portal into the loop.  
This article focuses on the **Cloud Portal** side of the SAML setup — uploading the IdP metadata, creating the SSO connection, checking claims, and running the first authentication tests.

Before you begin, make sure you’ve already collected:
- The **Federation Metadata XML** exported from Azure: `/sso/cloudportal-saml-[ENV].xml`
- A **list of Azure Group Object IDs** and **test users** from your preparation workshop

These are the building blocks that tie Azure and Sitecore together.

---

## 1. Add a New SSO Connection in Cloud Portal

1. Sign in to **Sitecore Cloud Portal** as an organisation or cloud administrator (`[Cloud Portal Admin Account]`).
2. Navigate to **Admin → SSO** (the location may differ slightly depending on UI updates).
3. Click **Add SSO Connection → SAML**.
4. Give the connection a descriptive name such as:
   - `Azure-SAML-DEV`
   - `Azure-SAML-UAT`
   - `Azure-SAML-PROD`
5. If prompted, add your organisation’s allowed email domains (for example, `yourcompany.com`).  
   This ensures that only trusted corporate accounts can use SSO.

> **Pro Tip:** Keep your connection names consistent across environments — it makes it easier to maintain your configuration and certificate paths.

---

## 2. Upload Federation Metadata

1. In the SAML connection setup screen, choose **Upload IdP Metadata**.  
2. Select the XML file you downloaded from Azure: `[Cloud Portal Metadata File]`.
3. Save the configuration.

Once uploaded, Cloud Portal will display the parsed IdP details — Issuer, SSO URL, and Certificate fingerprint.  
Double-check that these values match your Azure export. If anything looks off, re-download the metadata directly from the Azure Enterprise Application to avoid stale data.

---

## 3. Claims Mapping (Placeholder Only)

Cloud Portal includes a **Claims Mapping** interface that lets you align incoming claims (like `groups`) with internal portal roles or an `xmc_role` claim for XM Cloud.

At this stage:
- **Do not** hard-code or apply claim mappings yet.  
- Instead, document your intended mappings in a configuration table:
  - `[Azure Group Object ID]` → `xmc_role = [Sitecore Role]`

You’ll finalise this mapping in the dedicated claim-mapping deep dive later in the series.

> **Developer Note:** Each environment (DEV/UAT/PROD) often uses separate group Object IDs. Capture them clearly in your mapping spreadsheet to prevent mix-ups during deployment.

---

## 4. Test the Cloud Portal SSO

With the metadata uploaded, you’re ready for the first live test.

1. Sign out of Cloud Portal completely.  
2. Go to the portal sign-in page — it should now redirect to **Azure Entra ID**.  
3. Log in using one of your prepared test users:
   - Admin test: `[admin-test@yourcompany.com]`
   - Editor test: `[editor-test@yourcompany.com]`
4. Confirm:
   - The login flow successfully redirects through Azure and lands you back in Cloud Portal.
   - The user profile (or token view) displays the `groups` claim with the correct **Object ID** values.

If authentication fails:
- Re-check your **Basic SAML Configuration** (Entity ID and ACS URL) in both Azure and Sitecore.
- Confirm the user is **assigned** to the Azure Enterprise Application.
- Review the Azure sign-in logs for SAML assertion errors — they usually reveal what’s missing.

> **Tip:** If you only see a generic error screen, check the browser network tab for the SAML response payload — it can tell you whether Azure actually issued the token.

---

## 5. Operational Notes

| Topic | Guidance |
|--------|-----------|
| **Role Propagation** | Roles won’t appear immediately in XM Cloud. Cloud Portal issues the claims, but the XM Cloud configuration (handled later) interprets them. |
| **Certificate Rotation** | Keep a copy of your signed metadata in your repository and schedule a rotation reminder before expiry. Contact: `[SSO Certificate Owner Email]`. |
| **Logging** | Enable sign-in log forwarding for the Cloud Portal enterprise app in Azure → **Log Analytics Workspace** for proactive monitoring. |
| **Environment Sync** | Always replicate changes to all environments once tested in DEV — Cloud Portal settings aren’t automatically synced between orgs. |

---

## Validate

By this stage, you should have a functioning SSO handshake between **Azure Entra ID** and **Sitecore Cloud Portal**.  
Successful login confirms that SAML assertions and certificates are valid, even if roles are not yet being applied.  

If everything checks out, your environment is ready for claim mapping and XM Cloud integration.

---

## Summary

To recap, you’ve:
1. Created a new SAML connection in Cloud Portal  
2. Uploaded Azure’s Federation Metadata  
3. Validated sign-ins with test accounts  
4. Confirmed `groups` claims are being emitted

Next, we’ll move on to **Content Hub**, where we’ll extend SSO into Sitecore’s DAM platform and explore how to include group mappings for role-based provisioning.

> Coming up next: **Setting up Content Hub** — editing the Cloud Portal JSON config to register Azure as a SAML provider and preparing claim mapping for role propagation.
